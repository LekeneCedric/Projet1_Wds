{"ast":null,"code":"import _asyncToGenerator from \"/home/code237/Documents/GitHub/Projet1_Wds/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { of } from 'rxjs/internal/observable/of';\nlet EQUIPEMENTSComponent = class EQUIPEMENTSComponent {\n  constructor(service, categorieService, questionService) {\n    this.service = service;\n    this.categorieService = categorieService;\n    this.questionService = questionService;\n    this.currentPage = 0;\n    this.pageSize = 6;\n    this.totalPages = 0;\n    this.selected = 10;\n    this.equipements_list = [];\n    this.search = \"\";\n  }\n\n  getPage(page, size) {\n    let index = page * size;\n    let totalPages = ~~(this.equipements_list.length / size);\n    if (this.equipements_list.length % size != 0) totalPages++;\n    let pageEquipements = this.equipements_list.slice(index, index + size);\n    return of({\n      page: page,\n      size: size,\n      totalPages: totalPages,\n      equipements: pageEquipements\n    });\n  }\n\n  onGetPageEquipement() {\n    this.getPage(this.currentPage, this.pageSize).subscribe(data => {\n      this.equipements_list = data.equipements;\n      this.totalPages = data.totalPages;\n    });\n  }\n\n  onSelected(value) {\n    this.selected = Number(value);\n\n    if (this.selected != -1 || this.selected < this.equipements_list.length) {\n      this.pageSize = this.selected;\n    } else {\n      this.pageSize = this.equipements_list.length;\n    }\n\n    this.getListEquipements();\n  }\n\n  getListEquipements() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.service.getAllEquipements().subscribe(data => {\n        /*Et on les stocke dans notre variable (habitations_list)*/\n        _this.equipements_list = data.reverse();\n\n        _this.onGetPageEquipement();\n      });\n    })();\n  }\n\n  gotoPage(i) {\n    this.currentPage = i;\n    this.getListEquipements();\n  }\n\n  ngOnInit() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this2.service.getAllEquipements().subscribe(data => {\n        _this2.equipements_list = data.reverse();\n\n        _this2.onGetPageEquipement();\n\n        console.log(data);\n      });\n      yield _this2.categorieService.getAllCategory().subscribe(data => {\n        _this2.categories_list = data;\n        console.log(data);\n      });\n      yield _this2.questionService.getAllQuestions().subscribe(data => {\n        _this2.questions_list = data;\n        console.log(data);\n      });\n    })();\n  }\n\n  setCurrentEquipement(equipement) {\n    this.update_categorieintitule = equipement.categorieintitule;\n    this.update_choix = equipement.choix;\n    this.update_idcatergorie = equipement.idcategorie;\n    this.update_idquestion = equipement.idquestion;\n    this.update_intituletype = equipement.intituletype;\n    this.current_equipement = equipement;\n    console.log(equipement);\n  }\n\n  deleteEquipement(id) {\n    this.service.deleteEquipement(id).subscribe(data => {\n      console.log(data);\n      this.ngOnInit();\n    });\n  }\n\n  addEquipement() {\n    const equipement = {\n      idcategorie: this.new_idcatergorie,\n      idquestion: this.new_idquestion,\n      choix: this.new_choix,\n      created_at: new Date(),\n      updated_at: new Date() // categorieintitule:this.new_categorieintitule,\n      // intituletype:this.new_intituletype\n\n    };\n    this.service.postEquipement(equipement).subscribe(data => {\n      console.log(data);\n      this.ngOnInit();\n    });\n  }\n\n  updateEquipement() {\n    const updateEq = {\n      id: this.current_equipement?.id,\n      idcategorie: this.update_idcatergorie,\n      idquestion: this.update_idquestion,\n      choix: this.update_choix,\n      updated_at: new Date() // categorieintitule: this.update_categorieintitule,\n      // intituletype: this.update_intituletype,\n\n    };\n    console.log(updateEq);\n    this.service.putEquipement(updateEq).subscribe(data => {\n      console.log(data);\n      this.ngOnInit();\n    });\n  }\n\n  getCategory(id) {\n    let category;\n\n    if (typeof id === 'number') {\n      this.categorieService.getOneCategory(id).subscribe(data => {\n        category = data.intitule.toString();\n      }, err => {\n        console.log(err.message());\n      });\n    } else {\n      category = \"\";\n    }\n\n    return category;\n  }\n\n};\nEQUIPEMENTSComponent = __decorate([Component({\n  selector: 'app-equipements',\n  templateUrl: './equipements.component.html',\n  styleUrls: ['./equipements.component.scss']\n})], EQUIPEMENTSComponent);\nexport { EQUIPEMENTSComponent };","map":{"version":3,"mappings":"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","names":["Component","of","EQUIPEMENTSComponent","constructor","service","categorieService","questionService","getPage","page","size","index","totalPages","equipements_list","length","pageEquipements","slice","equipements","onGetPageEquipement","currentPage","pageSize","subscribe","data","onSelected","value","selected","Number","getListEquipements","getAllEquipements","reverse","gotoPage","i","ngOnInit","console","log","getAllCategory","categories_list","getAllQuestions","questions_list","setCurrentEquipement","equipement","update_categorieintitule","categorieintitule","update_choix","choix","update_idcatergorie","idcategorie","update_idquestion","idquestion","update_intituletype","intituletype","current_equipement","deleteEquipement","id","addEquipement","new_idcatergorie","new_idquestion","new_choix","created_at","Date","updated_at","postEquipement","updateEquipement","updateEq","putEquipement","getCategory","category","getOneCategory","intitule","toString","err","message","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["/home/code237/Documents/GitHub/Projet1_Wds/src/app/components/equipements/equipements.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Observable } from 'rxjs/internal/Observable';\nimport { of } from 'rxjs/internal/observable/of';\nimport ICategorie from 'src/app/models/categorie.models';\nimport IEquipement from 'src/app/models/equipement.models';\nimport PageEquipement from 'src/app/models/modelsPages/pageEquipement.models';\nimport IQuestion from 'src/app/models/question.models';\nimport { CategoriesService } from 'src/app/services/categories.service';\nimport { EquipementsService } from 'src/app/services/equipements.service';\nimport { QuestionsService } from 'src/app/services/questions.service';\n\n@Component({\n  selector: 'app-equipements',\n  templateUrl: './equipements.component.html',\n  styleUrls: ['./equipements.component.scss']\n})\nexport class EQUIPEMENTSComponent implements OnInit {\n\n  constructor(private service:EquipementsService,private categorieService:CategoriesService,\n              private questionService:QuestionsService) { }\n              currentPage:number = 0;\n              pageSize:number = 6;\n              totalPages:number = 0;\n              selected:number = 10;\n              getPage(page:number,size:number):Observable<PageEquipement>{\n              \n                let index = page * size;\n                let totalPages = ~~(this.equipements_list.length/size);\n                if(this.equipements_list.length % size != 0)\n                  totalPages ++;\n                let pageEquipements = this.equipements_list.slice(index,index+size);\n                return of({\n                  page:page,\n                  size:size,\n                  totalPages:totalPages,\n                  equipements:pageEquipements\n                })\n              }\n            \n              onGetPageEquipement(): void {\n                this.getPage(this.currentPage,this.pageSize)\n                .subscribe(\n                  (data)=> {\n                    this.equipements_list = data.equipements;\n                    this.totalPages = data.totalPages;\n            \n            \n                  }\n                )\n              }\n            \n             \n              onSelected(value:string): void {\n                this.selected = Number(value);\n                if(this.selected != -1 || this.selected < this.equipements_list.length){\n                  this.pageSize = this.selected;\n                }else{\n                  this.pageSize =this.equipements_list.length;\n                }\n                this.getListEquipements();\n              }\n            \n              async getListEquipements(){\n                await this.service.getAllEquipements().subscribe(data=>{\n                  /*Et on les stocke dans notre variable (habitations_list)*/\n                  this.equipements_list = data.reverse();\n                  this.onGetPageEquipement();\n                })\n              }\n              \n              gotoPage(i:number){\n                this.currentPage = i;\n                this.getListEquipements();\n            \n              }\n  update_idcatergorie?:number;\n  update_idquestion?:number;\n  update_choix?:string;\n  update_created_at?:Date;\n  update_updated_at?:Date;\n  update_categorieintitule?:string;\n  update_intituletype?:string;\n  /******************************************/\n  new_idcatergorie?:number;\n  new_idquestion?:number;\n  new_choix?:string;\n  new_created_at?:Date;\n  new_updated_at?:Date;\n  new_categorieintitule?:string;\n  new_intituletype?:string;\n\n  /*******************************************/\n  /**Au lieur de proposer a l'admin d'entrer manuellement les idcategorie \n   * et idquestion correspondantes , nous allons lui permettre de choisier dans une \n   * list les differentes categories et questions et recuperer les id correspondant \n   * en backend\n   */\n  categories_list?:ICategorie[];\n  questions_list?:any[]\n  current_equipement?:IEquipement;\n  equipements_list:any[]=[];\n  search : string = \"\";\n  \n\n  async ngOnInit(){\n   \n    await this.service.getAllEquipements().subscribe(\n      data=>{\n        this.equipements_list = data.reverse();\n        this.onGetPageEquipement();\n        console.log(data);\n      }\n    )\n    await this.categorieService.getAllCategory().subscribe(\n      data=>{\n        this.categories_list = data;\n        console.log(data);\n      }\n    )\n    await this.questionService.getAllQuestions().subscribe(\n      data=>{\n        this.questions_list = data;\n        console.log(data);\n      }\n    )\n  }\n\n  setCurrentEquipement(equipement:IEquipement){\n    this.update_categorieintitule=equipement.categorieintitule;\n    this.update_choix = equipement.choix;\n    this.update_idcatergorie = equipement.idcategorie;\n    this.update_idquestion = equipement.idquestion;\n    this.update_intituletype = equipement.intituletype;\n    this.current_equipement = equipement;\n    console.log(equipement);\n  }\n\n  deleteEquipement(id:any){\n    this.service.deleteEquipement(id).subscribe(\n      data=>{\n        console.log(data);\n        this.ngOnInit();\n      }\n    );\n  }\n\n  addEquipement(){\n    const equipement :IEquipement = {\n      idcategorie: this.new_idcatergorie,\n      idquestion: this.new_idquestion,\n      choix: this.new_choix,\n      created_at: new Date(),\n      updated_at: new Date(),\n      // categorieintitule:this.new_categorieintitule,\n      // intituletype:this.new_intituletype\n    }\n    this.service.postEquipement(equipement).subscribe(\n      data=>{\n        console.log(data);\n        this.ngOnInit();\n      }\n    );\n  }\n  updateEquipement(){\n    const updateEq : IEquipement = {\n      id:this.current_equipement?.id,\n      idcategorie: this.update_idcatergorie,\n      idquestion: this.update_idquestion,\n      choix: this.update_choix,\n      updated_at: new Date(),\n      // categorieintitule: this.update_categorieintitule,\n      // intituletype: this.update_intituletype,\n    }\n    console.log(updateEq);\n    this.service.putEquipement(updateEq).subscribe(\n      data=>{\n        console.log(data);\n        this.ngOnInit();\n      }\n    )\n  }\n getCategory(id:any):string{\n  let category!:string;\n  if(typeof id === 'number'){\n    \n    this.categorieService.getOneCategory(id).subscribe(\n     (data)=>{\n       category = data.intitule.toString();\n     },\n     (err)=>{\n       console.log(err.message())\n     }\n    )\n  }\n  else {\n    category = \"\";\n  }\n  \n   return category;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}